<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Alexandros Sivris TAS contribution: VisualLocalization Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Alexandros Sivris TAS contribution
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classVisualLocalization-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">VisualLocalization Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classVisualLocalization.html" title="The VisualLocalization class In this class the position of the car is estimated by using visual data ...">VisualLocalization</a> class In this class the position of the car is estimated by using visual data from an RGB camera as well as laser data from the Hokuyo laser scanner. The initial position is found by the solution of a nonlinear system of three circle equations and the pose estimate during the driving is done by inspecting the difference between the poses in the particle cloud and the points in the circle around the recognized landmark with radius equal to the distance obtained from the laser scanner (cf. method <a class="el" href="classVisualLocalization.html#ae30620e046591295e3a27ee84d6f4f26" title="VisualLocalization::simpleLocalization Simple localization approach. The two options for the pose est...">simpleLocalization(TemplateImgData &amp;_tpl)</a> for more detail).  
 <a href="classVisualLocalization.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="visuallocalization_8h_source.html">visuallocalization.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0d9dd58e3ea581157a170e0d0116909d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a0d9dd58e3ea581157a170e0d0116909d">localize</a> ()</td></tr>
<tr class="memdesc:a0d9dd58e3ea581157a170e0d0116909d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#a0d9dd58e3ea581157a170e0d0116909d" title="VisualLocalization::localize loop of process. When the initial localization is successful the orienta...">VisualLocalization::localize</a> loop of process. When the initial localization is successful the orientation of the nav_origin frame is calculated and finally the frame is published using a tf broadcaster.  <a href="#a0d9dd58e3ea581157a170e0d0116909d">More...</a><br/></td></tr>
<tr class="separator:a0d9dd58e3ea581157a170e0d0116909d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11d6b88a29873dbb45f70fa2abdbd2b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a11d6b88a29873dbb45f70fa2abdbd2b3">VisualLocalization</a> (ros::NodeHandle _nh, vector&lt; string &gt; &amp;_lm_names, vector&lt; <a class="el" href="structLoadedTemplateData.html">LoadedTemplateData</a> &gt; &amp;_loaded_tpls, bool _use_map_img, string _map_path)</td></tr>
<tr class="memdesc:a11d6b88a29873dbb45f70fa2abdbd2b3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#a11d6b88a29873dbb45f70fa2abdbd2b3" title="VisualLocalization::VisualLocalization In the constructor the landmark images are loaded and saved in...">VisualLocalization::VisualLocalization</a> In the constructor the landmark images are loaded and saved into a vector. Each landmark and each template gets a unique id with which it can be conveniently specified. Optionally the map is loaded from an image file (JPG/PNG) instead of fetching it from hector_compressed_map_transport (recommended). Moreover, the subscribers and publishers are prepared.  <a href="#a11d6b88a29873dbb45f70fa2abdbd2b3">More...</a><br/></td></tr>
<tr class="separator:a11d6b88a29873dbb45f70fa2abdbd2b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d4fcc027d3b8e2af12cd35cca429ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ab6d4fcc027d3b8e2af12cd35cca429ed">~VisualLocalization</a> ()</td></tr>
<tr class="memdesc:ab6d4fcc027d3b8e2af12cd35cca429ed"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#ab6d4fcc027d3b8e2af12cd35cca429ed" title="VisualLocalization::~VisualLocalization some garbage collection. ">VisualLocalization::~VisualLocalization</a> some garbage collection.  <a href="#ab6d4fcc027d3b8e2af12cd35cca429ed">More...</a><br/></td></tr>
<tr class="separator:ab6d4fcc027d3b8e2af12cd35cca429ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a9e48b91a6ade88332b227e0aeb214214"><td class="memItemLeft" align="right" valign="top">static constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a9e48b91a6ade88332b227e0aeb214214">min_scan_angle</a> = -1.57</td></tr>
<tr class="memdesc:a9e48b91a6ade88332b227e0aeb214214"><td class="mdescLeft">&#160;</td><td class="mdescRight">from scan message  <a href="#a9e48b91a6ade88332b227e0aeb214214">More...</a><br/></td></tr>
<tr class="separator:a9e48b91a6ade88332b227e0aeb214214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab388f9ea3f09bbb0a0e59e5a78fc749c"><td class="memItemLeft" align="right" valign="top">static constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ab388f9ea3f09bbb0a0e59e5a78fc749c">max_scan_angle</a> = 1.57</td></tr>
<tr class="separator:ab388f9ea3f09bbb0a0e59e5a78fc749c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d6846c3a7d4a75c3b2410fac9a1e21"><td class="memItemLeft" align="right" valign="top">static constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a89d6846c3a7d4a75c3b2410fac9a1e21">world_distance_btwn_tpl</a> = 2.0</td></tr>
<tr class="separator:a89d6846c3a7d4a75c3b2410fac9a1e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a38b961874036d47ab6cccc34b899087f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a38b961874036d47ab6cccc34b899087f">publishPose</a> (Point2f &amp;_pose)</td></tr>
<tr class="memdesc:a38b961874036d47ab6cccc34b899087f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#a38b961874036d47ab6cccc34b899087f" title="VisualLocalization::publishPose publish the position of the car into the /initialpose topic...">VisualLocalization::publishPose</a> publish the position of the car into the /initialpose topic. In case of initial localization, the orientation is also set for the nav_origin frame.  <a href="#a38b961874036d47ab6cccc34b899087f">More...</a><br/></td></tr>
<tr class="separator:a38b961874036d47ab6cccc34b899087f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae30620e046591295e3a27ee84d6f4f26"><td class="memItemLeft" align="right" valign="top">Point2f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ae30620e046591295e3a27ee84d6f4f26">simpleLocalization</a> (<a class="el" href="structTemplateImgData.html">TemplateImgData</a> &amp;_tpl)</td></tr>
<tr class="memdesc:ae30620e046591295e3a27ee84d6f4f26"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#ae30620e046591295e3a27ee84d6f4f26" title="VisualLocalization::simpleLocalization Simple localization approach. The two options for the pose est...">VisualLocalization::simpleLocalization</a> Simple localization approach. The two options for the pose estimate are: 1.) the point in the particle cloud (from AMCL) which lies within 20cm on the circle around the landmark with radius equal to the distance of the landmark from the car. 2.) the point on the circle which is closest to the particle cloud.  <a href="#ae30620e046591295e3a27ee84d6f4f26">More...</a><br/></td></tr>
<tr class="separator:ae30620e046591295e3a27ee84d6f4f26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeefcf718d226c02c60e0ebee997c9374"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aeefcf718d226c02c60e0ebee997c9374">anyOfType</a> (vector&lt; <a class="el" href="structTemplateImgData.html">TemplateImgData</a> &gt; &amp;_tpl_vec, unsigned int &amp;_id)</td></tr>
<tr class="memdesc:aeefcf718d226c02c60e0ebee997c9374"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#aeefcf718d226c02c60e0ebee997c9374" title="VisualLocalization::anyOfType search the template vector for a given id. ">VisualLocalization::anyOfType</a> search the template vector for a given id.  <a href="#aeefcf718d226c02c60e0ebee997c9374">More...</a><br/></td></tr>
<tr class="separator:aeefcf718d226c02c60e0ebee997c9374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab88a3aac781c0d6e99b5dfd0139302cd"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ab88a3aac781c0d6e99b5dfd0139302cd">getRangeFromAngle</a> (double &amp;_angle)</td></tr>
<tr class="memdesc:ab88a3aac781c0d6e99b5dfd0139302cd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#ab88a3aac781c0d6e99b5dfd0139302cd" title="VisualLocalization::getRangeFromAngle convert an angle in the FOV to a range index in the lidar...">VisualLocalization::getRangeFromAngle</a> convert an angle in the FOV to a range index in the lidar.  <a href="#ab88a3aac781c0d6e99b5dfd0139302cd">More...</a><br/></td></tr>
<tr class="separator:ab88a3aac781c0d6e99b5dfd0139302cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abddfb494153dca6f8c323d9f02798d86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#abddfb494153dca6f8c323d9f02798d86">convertPointToAngle</a> (<a class="el" href="structTemplateImgData.html">TemplateImgData</a> &amp;_pt)</td></tr>
<tr class="memdesc:abddfb494153dca6f8c323d9f02798d86"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#abddfb494153dca6f8c323d9f02798d86" title="VisualLocalization::convertPointToAngle convert a pixel point to an angle in the FOV. ">VisualLocalization::convertPointToAngle</a> convert a pixel point to an angle in the FOV.  <a href="#abddfb494153dca6f8c323d9f02798d86">More...</a><br/></td></tr>
<tr class="separator:abddfb494153dca6f8c323d9f02798d86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac5d4b58545db8c3034c8bddf5680e1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aac5d4b58545db8c3034c8bddf5680e1e">broadcastOriginFrame</a> ()</td></tr>
<tr class="memdesc:aac5d4b58545db8c3034c8bddf5680e1e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#aac5d4b58545db8c3034c8bddf5680e1e" title="VisualLocalization::broadcastOriginFrame broadcast the nav_origin frame using a tf Transform and gett...">VisualLocalization::broadcastOriginFrame</a> broadcast the nav_origin frame using a tf Transform and getting the position/angle from the estimated car position.  <a href="#aac5d4b58545db8c3034c8bddf5680e1e">More...</a><br/></td></tr>
<tr class="separator:aac5d4b58545db8c3034c8bddf5680e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef7bce395d06c902c2c1a6c5dcf71fe7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aef7bce395d06c902c2c1a6c5dcf71fe7">calculateOriginOrientation</a> ()</td></tr>
<tr class="memdesc:aef7bce395d06c902c2c1a6c5dcf71fe7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#aef7bce395d06c902c2c1a6c5dcf71fe7" title="VisualLocalization::calculateOriginOrientation The orientation of the origin is set accordin to the v...">VisualLocalization::calculateOriginOrientation</a> The orientation of the origin is set accordin to the vector pointing from the car position to the centroid of the three landmarks. As the centroid is not in the middle of the lane, this orientation is not 100% accurate, but AMCL can correct small deviations over time.  <a href="#aef7bce395d06c902c2c1a6c5dcf71fe7">More...</a><br/></td></tr>
<tr class="separator:aef7bce395d06c902c2c1a6c5dcf71fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a38d85e8c2f2e8a3987f709576d823"><td class="memItemLeft" align="right" valign="top">Point2f&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a05a38d85e8c2f2e8a3987f709576d823">estimatePosition</a> (vector&lt; <a class="el" href="structLandmarkData.html">LandmarkData</a> &gt; &amp;_lm, float da, float db, float dc)</td></tr>
<tr class="memdesc:a05a38d85e8c2f2e8a3987f709576d823"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#a05a38d85e8c2f2e8a3987f709576d823" title="VisualLocalization::estimatePosition estimate position of car based on its distance from the landmark...">VisualLocalization::estimatePosition</a> estimate position of car based on its distance from the landmarks. For the three landmarks (call them A,B,C) we know the distances and so we can write a system of three non-linear equations: I: (dist_a)^2 = (x-x_a)^2 + (x-x_b)^2 II: (dist_b)^2 = (x-x_b)^2 + (x-x_b)^2 III: (dist_c)^2 = (x-x_c)^2 + (x-x_c)^2 the solution of this system is evaluated in this method.  <a href="#a05a38d85e8c2f2e8a3987f709576d823">More...</a><br/></td></tr>
<tr class="separator:a05a38d85e8c2f2e8a3987f709576d823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045c1a0993ac532fd63003c72e769ef9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a045c1a0993ac532fd63003c72e769ef9">locateLandmarksInMap</a> ()</td></tr>
<tr class="memdesc:a045c1a0993ac532fd63003c72e769ef9"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#a045c1a0993ac532fd63003c72e769ef9" title="VisualLocalization::locateLandmarksInMap instantiate LandmarkMatcher object, which calculates landmar...">VisualLocalization::locateLandmarksInMap</a> instantiate <a class="el" href="classLandmarkMatcher.html" title="The LandmarkMatcher class find landmark positions in the map using template matching from OpenCV...">LandmarkMatcher</a> object, which calculates landmark map coordinates.  <a href="#a045c1a0993ac532fd63003c72e769ef9">More...</a><br/></td></tr>
<tr class="separator:a045c1a0993ac532fd63003c72e769ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af703fd094a6dc992581bb7954a4a510b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#af703fd094a6dc992581bb7954a4a510b">cbAmclPose</a> (const geometry_msgs::PoseWithCovariance::ConstPtr &amp;msg)</td></tr>
<tr class="memdesc:af703fd094a6dc992581bb7954a4a510b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#af703fd094a6dc992581bb7954a4a510b" title="VisualLocalization::cbAmclPose callback function of &quot;/amcl_pose&quot;. Member attribute m_amclPose is set ...">VisualLocalization::cbAmclPose</a> callback function of "/amcl_pose". Member attribute m_amclPose is set to the msg pose.  <a href="#af703fd094a6dc992581bb7954a4a510b">More...</a><br/></td></tr>
<tr class="separator:af703fd094a6dc992581bb7954a4a510b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af24bab6e4fa9dce96a819264699fee89"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#af24bab6e4fa9dce96a819264699fee89">cbCamImg</a> (const sensor_msgs::Image::ConstPtr &amp;_img)</td></tr>
<tr class="memdesc:af24bab6e4fa9dce96a819264699fee89"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#af24bab6e4fa9dce96a819264699fee89" title="VisualLocalization::cbCamImg callback function of camera image. The camera image is published from th...">VisualLocalization::cbCamImg</a> callback function of camera image. The camera image is published from the usb_cam package. Every image frame is searched for templates and if any are found, their position is saved in the m_detectedTpl vector. The triangluation approach is only executed when three landmarks are detected. If only one is detected a simpler localization approach is done.  <a href="#af24bab6e4fa9dce96a819264699fee89">More...</a><br/></td></tr>
<tr class="separator:af24bab6e4fa9dce96a819264699fee89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af72fb58b92100e7215521c90203e3e4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#af72fb58b92100e7215521c90203e3e4f">cbTplDetect</a> (const geometry_msgs::PoseArray::ConstPtr &amp;msg)</td></tr>
<tr class="memdesc:af72fb58b92100e7215521c90203e3e4f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#af72fb58b92100e7215521c90203e3e4f" title="VisualLocalization::cbTplDetect (Alternative) callback function that gets called when 3 templates are...">VisualLocalization::cbTplDetect</a> (Alternative) callback function that gets called when 3 templates are detected. The method is not used during the current execution of the node. The purpose of this method is to act as an interface between my node and Benni's object_detection node that finds the templates by SIFT.  <a href="#af72fb58b92100e7215521c90203e3e4f">More...</a><br/></td></tr>
<tr class="separator:af72fb58b92100e7215521c90203e3e4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace24662571a6c52c54b3c2d8a1f2378a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ace24662571a6c52c54b3c2d8a1f2378a">cbMap</a> (const sensor_msgs::ImageConstPtr &amp;msg)</td></tr>
<tr class="memdesc:ace24662571a6c52c54b3c2d8a1f2378a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#ace24662571a6c52c54b3c2d8a1f2378a" title="VisualLocalization::cbMap callback function when message is received from hector_compressed_map_trans...">VisualLocalization::cbMap</a> callback function when message is received from hector_compressed_map_transport package. As soon as a message is received the templates are localized within the image of the map.  <a href="#ace24662571a6c52c54b3c2d8a1f2378a">More...</a><br/></td></tr>
<tr class="separator:ace24662571a6c52c54b3c2d8a1f2378a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7279ea7c6413cc17500684755f9e3b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aa7279ea7c6413cc17500684755f9e3b9">cbLaserScan</a> (const sensor_msgs::LaserScan::ConstPtr &amp;scan)</td></tr>
<tr class="memdesc:aa7279ea7c6413cc17500684755f9e3b9"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#aa7279ea7c6413cc17500684755f9e3b9" title="VisualLocalization::cbLaserScan get distance measure from laser scanner. ">VisualLocalization::cbLaserScan</a> get distance measure from laser scanner.  <a href="#aa7279ea7c6413cc17500684755f9e3b9">More...</a><br/></td></tr>
<tr class="separator:aa7279ea7c6413cc17500684755f9e3b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f7bd6939465f5d79ab2a6774c98dc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a58f7bd6939465f5d79ab2a6774c98dc0">cbParticles</a> (const geometry_msgs::PoseArray::ConstPtr &amp;_particles)</td></tr>
<tr class="memdesc:a58f7bd6939465f5d79ab2a6774c98dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisualLocalization.html#a58f7bd6939465f5d79ab2a6774c98dc0" title="VisualLocalization::cbParticles fetch poses from amcl and store them in a member attribute. ">VisualLocalization::cbParticles</a> fetch poses from amcl and store them in a member attribute.  <a href="#a58f7bd6939465f5d79ab2a6774c98dc0">More...</a><br/></td></tr>
<tr class="separator:a58f7bd6939465f5d79ab2a6774c98dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a1b82cdb4ed734024766ea42133696885"><td class="memItemLeft" align="right" valign="top">geometry_msgs::PoseArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a1b82cdb4ed734024766ea42133696885">m_particleCloud</a></td></tr>
<tr class="separator:a1b82cdb4ed734024766ea42133696885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e721d8dddb292d2b1bdb5ccefa1d08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structCarPosition.html">CarPosition</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a53e721d8dddb292d2b1bdb5ccefa1d08">m_carOrigin</a></td></tr>
<tr class="memdesc:a53e721d8dddb292d2b1bdb5ccefa1d08"><td class="mdescLeft">&#160;</td><td class="mdescRight">2D position of car in the map AND orientation  <a href="#a53e721d8dddb292d2b1bdb5ccefa1d08">More...</a><br/></td></tr>
<tr class="separator:a53e721d8dddb292d2b1bdb5ccefa1d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a8d3f235e1e7beab8d86c80b146fee"><td class="memItemLeft" align="right" valign="top">tf::Vector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a66a8d3f235e1e7beab8d86c80b146fee">m_camPositionInBaseLink</a></td></tr>
<tr class="memdesc:a66a8d3f235e1e7beab8d86c80b146fee"><td class="mdescLeft">&#160;</td><td class="mdescRight">camera frame location relative to base link frame  <a href="#a66a8d3f235e1e7beab8d86c80b146fee">More...</a><br/></td></tr>
<tr class="separator:a66a8d3f235e1e7beab8d86c80b146fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f62a13a37965d0bd397704e75315993"><td class="memItemLeft" align="right" valign="top">tf::TransformListener&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a3f62a13a37965d0bd397704e75315993">m_tfListener</a></td></tr>
<tr class="memdesc:a3f62a13a37965d0bd397704e75315993"><td class="mdescLeft">&#160;</td><td class="mdescRight">tf listener  <a href="#a3f62a13a37965d0bd397704e75315993">More...</a><br/></td></tr>
<tr class="separator:a3f62a13a37965d0bd397704e75315993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd309550c21c60689d4477057b724deb"><td class="memItemLeft" align="right" valign="top">tf::TransformBroadcaster&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#afd309550c21c60689d4477057b724deb">m_originBroadcaster</a></td></tr>
<tr class="memdesc:afd309550c21c60689d4477057b724deb"><td class="mdescLeft">&#160;</td><td class="mdescRight">tf broadcaster for initial position/nav_origin frame  <a href="#afd309550c21c60689d4477057b724deb">More...</a><br/></td></tr>
<tr class="separator:afd309550c21c60689d4477057b724deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2820938a4d8bc2d263a84e9c17013e61"><td class="memItemLeft" align="right" valign="top">ros::NodeHandle &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a2820938a4d8bc2d263a84e9c17013e61">m_nh</a></td></tr>
<tr class="memdesc:a2820938a4d8bc2d263a84e9c17013e61"><td class="mdescLeft">&#160;</td><td class="mdescRight">node handle  <a href="#a2820938a4d8bc2d263a84e9c17013e61">More...</a><br/></td></tr>
<tr class="separator:a2820938a4d8bc2d263a84e9c17013e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dcf58c7269815aeb8bf42b21ebee8f2"><td class="memItemLeft" align="right" valign="top">ros::Subscriber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a7dcf58c7269815aeb8bf42b21ebee8f2">m_subScan</a></td></tr>
<tr class="memdesc:a7dcf58c7269815aeb8bf42b21ebee8f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscribe to scan topic  <a href="#a7dcf58c7269815aeb8bf42b21ebee8f2">More...</a><br/></td></tr>
<tr class="separator:a7dcf58c7269815aeb8bf42b21ebee8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af41830fbed0ab025bef6af4ffc6ad97f"><td class="memItemLeft" align="right" valign="top">ros::Subscriber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#af41830fbed0ab025bef6af4ffc6ad97f">m_subAmclPose</a></td></tr>
<tr class="memdesc:af41830fbed0ab025bef6af4ffc6ad97f"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscribe to pose estimation by amcl  <a href="#af41830fbed0ab025bef6af4ffc6ad97f">More...</a><br/></td></tr>
<tr class="separator:af41830fbed0ab025bef6af4ffc6ad97f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a695b678e8f29f3a19e5e9b92a189e97d"><td class="memItemLeft" align="right" valign="top">ros::Subscriber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a695b678e8f29f3a19e5e9b92a189e97d">m_subCamImg</a></td></tr>
<tr class="memdesc:a695b678e8f29f3a19e5e9b92a189e97d"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscribe to /usb_cam/image_raw  <a href="#a695b678e8f29f3a19e5e9b92a189e97d">More...</a><br/></td></tr>
<tr class="separator:a695b678e8f29f3a19e5e9b92a189e97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7966234a43ba4f9f8f2abe0918ea5a9d"><td class="memItemLeft" align="right" valign="top">ros::Subscriber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a7966234a43ba4f9f8f2abe0918ea5a9d">m_subTplDetection</a></td></tr>
<tr class="memdesc:a7966234a43ba4f9f8f2abe0918ea5a9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscriber to /tpl_detect  <a href="#a7966234a43ba4f9f8f2abe0918ea5a9d">More...</a><br/></td></tr>
<tr class="separator:a7966234a43ba4f9f8f2abe0918ea5a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e83c5a0d1b395353aec8cdba3de86a1"><td class="memItemLeft" align="right" valign="top">ros::Subscriber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a9e83c5a0d1b395353aec8cdba3de86a1">m_subMap</a></td></tr>
<tr class="memdesc:a9e83c5a0d1b395353aec8cdba3de86a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscriber to /map_image/full  <a href="#a9e83c5a0d1b395353aec8cdba3de86a1">More...</a><br/></td></tr>
<tr class="separator:a9e83c5a0d1b395353aec8cdba3de86a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa15109f2af86ac566583ed558d4930b9"><td class="memItemLeft" align="right" valign="top">ros::Subscriber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aa15109f2af86ac566583ed558d4930b9">m_subParticles</a></td></tr>
<tr class="memdesc:aa15109f2af86ac566583ed558d4930b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscriber to /particlecloud  <a href="#aa15109f2af86ac566583ed558d4930b9">More...</a><br/></td></tr>
<tr class="separator:aa15109f2af86ac566583ed558d4930b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2b216ad28cfed9f912845c003d18f2"><td class="memItemLeft" align="right" valign="top">ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aca2b216ad28cfed9f912845c003d18f2">m_pubPosition</a></td></tr>
<tr class="memdesc:aca2b216ad28cfed9f912845c003d18f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">publisher of pose estimate from localization results  <a href="#aca2b216ad28cfed9f912845c003d18f2">More...</a><br/></td></tr>
<tr class="separator:aca2b216ad28cfed9f912845c003d18f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae99c41dd8eaec829df9151a6a355fcad"><td class="memItemLeft" align="right" valign="top">ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ae99c41dd8eaec829df9151a6a355fcad">m_pubLandmarks</a></td></tr>
<tr class="memdesc:ae99c41dd8eaec829df9151a6a355fcad"><td class="mdescLeft">&#160;</td><td class="mdescRight">publisher of landmark positions  <a href="#ae99c41dd8eaec829df9151a6a355fcad">More...</a><br/></td></tr>
<tr class="separator:ae99c41dd8eaec829df9151a6a355fcad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862a0a20423d73fb1e8a01479d9f5b43"><td class="memItemLeft" align="right" valign="top">geometry_msgs::PoseWithCovariance&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a862a0a20423d73fb1e8a01479d9f5b43">m_amclPose</a></td></tr>
<tr class="memdesc:a862a0a20423d73fb1e8a01479d9f5b43"><td class="mdescLeft">&#160;</td><td class="mdescRight">AMCL pose estimate (from "/amcl_pose" topic)  <a href="#a862a0a20423d73fb1e8a01479d9f5b43">More...</a><br/></td></tr>
<tr class="separator:a862a0a20423d73fb1e8a01479d9f5b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeeac77dbd819c58382513b00f946a15"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#aeeeac77dbd819c58382513b00f946a15">m_camImg</a></td></tr>
<tr class="memdesc:aeeeac77dbd819c58382513b00f946a15"><td class="mdescLeft">&#160;</td><td class="mdescRight">camera image is saved into an OpenCV Mat format  <a href="#aeeeac77dbd819c58382513b00f946a15">More...</a><br/></td></tr>
<tr class="separator:aeeeac77dbd819c58382513b00f946a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521a5d5f9441e04b207e9904712448a5"><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a521a5d5f9441e04b207e9904712448a5">m_mapImg</a></td></tr>
<tr class="memdesc:a521a5d5f9441e04b207e9904712448a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">map in Mat format for further processing  <a href="#a521a5d5f9441e04b207e9904712448a5">More...</a><br/></td></tr>
<tr class="separator:a521a5d5f9441e04b207e9904712448a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc5f72813488a0f0aa7e9a9cb5a0dc53"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#acc5f72813488a0f0aa7e9a9cb5a0dc53">m_gotMap</a></td></tr>
<tr class="memdesc:acc5f72813488a0f0aa7e9a9cb5a0dc53"><td class="mdescLeft">&#160;</td><td class="mdescRight">a flag is set when the map image is received  <a href="#acc5f72813488a0f0aa7e9a9cb5a0dc53">More...</a><br/></td></tr>
<tr class="separator:acc5f72813488a0f0aa7e9a9cb5a0dc53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe376f70f7c845fca8174c01697e21a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#adbe376f70f7c845fca8174c01697e21a">m_gotPoseArray</a></td></tr>
<tr class="memdesc:adbe376f70f7c845fca8174c01697e21a"><td class="mdescLeft">&#160;</td><td class="mdescRight">set true when amcl particle cloud is received  <a href="#adbe376f70f7c845fca8174c01697e21a">More...</a><br/></td></tr>
<tr class="separator:adbe376f70f7c845fca8174c01697e21a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a142c0b69def02005bd110a6a437656e0"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="structLoadedTemplateData.html">LoadedTemplateData</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a142c0b69def02005bd110a6a437656e0">m_loadedTemplates</a></td></tr>
<tr class="memdesc:a142c0b69def02005bd110a6a437656e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">reference to loaded templates  <a href="#a142c0b69def02005bd110a6a437656e0">More...</a><br/></td></tr>
<tr class="separator:a142c0b69def02005bd110a6a437656e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5656ed36f8f00c3799d0e26c2f6bea6"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="structLandmarkData.html">LandmarkData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ad5656ed36f8f00c3799d0e26c2f6bea6">m_landmarks</a></td></tr>
<tr class="memdesc:ad5656ed36f8f00c3799d0e26c2f6bea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">contains position of landmarks in the map (world coordinates)  <a href="#ad5656ed36f8f00c3799d0e26c2f6bea6">More...</a><br/></td></tr>
<tr class="separator:ad5656ed36f8f00c3799d0e26c2f6bea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b40bd60b1e0f9dc3292e5a633bc367"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="structTemplateImgData.html">TemplateImgData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#ac2b40bd60b1e0f9dc3292e5a633bc367">m_detectedTpl</a></td></tr>
<tr class="memdesc:ac2b40bd60b1e0f9dc3292e5a633bc367"><td class="mdescLeft">&#160;</td><td class="mdescRight">contains position of templates in pixel and world coordinates,as well as the distance from the car  <a href="#ac2b40bd60b1e0f9dc3292e5a633bc367">More...</a><br/></td></tr>
<tr class="separator:ac2b40bd60b1e0f9dc3292e5a633bc367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003f1e5ce410a0a34648cea415b2bd75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLandmarkMatcher.html">LandmarkMatcher</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a003f1e5ce410a0a34648cea415b2bd75">m_pLandmarkMatcher</a></td></tr>
<tr class="memdesc:a003f1e5ce410a0a34648cea415b2bd75"><td class="mdescLeft">&#160;</td><td class="mdescRight">used to find landmarks in map (not in camera image)  <a href="#a003f1e5ce410a0a34648cea415b2bd75">More...</a><br/></td></tr>
<tr class="separator:a003f1e5ce410a0a34648cea415b2bd75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf1f11084b51fa47f8db87412d4819e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a6cf1f11084b51fa47f8db87412d4819e">m_bInitLocalization</a></td></tr>
<tr class="memdesc:a6cf1f11084b51fa47f8db87412d4819e"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag unset when initial localization has successfully happened  <a href="#a6cf1f11084b51fa47f8db87412d4819e">More...</a><br/></td></tr>
<tr class="separator:a6cf1f11084b51fa47f8db87412d4819e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b154a7b8d5125930da1087ad277d9d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLandmarkDetector.html">LandmarkDetector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisualLocalization.html#a8b154a7b8d5125930da1087ad277d9d8">m_pLandmarkDetector</a></td></tr>
<tr class="separator:a8b154a7b8d5125930da1087ad277d9d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classVisualLocalization.html" title="The VisualLocalization class In this class the position of the car is estimated by using visual data ...">VisualLocalization</a> class In this class the position of the car is estimated by using visual data from an RGB camera as well as laser data from the Hokuyo laser scanner. The initial position is found by the solution of a nonlinear system of three circle equations and the pose estimate during the driving is done by inspecting the difference between the poses in the particle cloud and the points in the circle around the recognized landmark with radius equal to the distance obtained from the laser scanner (cf. method <a class="el" href="classVisualLocalization.html#ae30620e046591295e3a27ee84d6f4f26" title="VisualLocalization::simpleLocalization Simple localization approach. The two options for the pose est...">simpleLocalization(TemplateImgData &amp;_tpl)</a> for more detail). </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a11d6b88a29873dbb45f70fa2abdbd2b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VisualLocalization::VisualLocalization </td>
          <td>(</td>
          <td class="paramtype">ros::NodeHandle&#160;</td>
          <td class="paramname"><em>_nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; string &gt; &amp;&#160;</td>
          <td class="paramname"><em>_lm_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="structLoadedTemplateData.html">LoadedTemplateData</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>_loaded_tpls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_use_map_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>_map_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#a11d6b88a29873dbb45f70fa2abdbd2b3" title="VisualLocalization::VisualLocalization In the constructor the landmark images are loaded and saved in...">VisualLocalization::VisualLocalization</a> In the constructor the landmark images are loaded and saved into a vector. Each landmark and each template gets a unique id with which it can be conveniently specified. Optionally the map is loaded from an image file (JPG/PNG) instead of fetching it from hector_compressed_map_transport (recommended). Moreover, the subscribers and publishers are prepared. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_nh</td><td></td></tr>
    <tr><td class="paramname">_lm_names</td><td></td></tr>
    <tr><td class="paramname">_loaded_tpls</td><td></td></tr>
    <tr><td class="paramname">_use_map_img</td><td></td></tr>
    <tr><td class="paramname">_map_path</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab6d4fcc027d3b8e2af12cd35cca429ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VisualLocalization::~VisualLocalization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#ab6d4fcc027d3b8e2af12cd35cca429ed" title="VisualLocalization::~VisualLocalization some garbage collection. ">VisualLocalization::~VisualLocalization</a> some garbage collection. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aeefcf718d226c02c60e0ebee997c9374"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool VisualLocalization::anyOfType </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="structTemplateImgData.html">TemplateImgData</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>_tpl_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#aeefcf718d226c02c60e0ebee997c9374" title="VisualLocalization::anyOfType search the template vector for a given id. ">VisualLocalization::anyOfType</a> search the template vector for a given id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_tpl_vec</td><td></td></tr>
    <tr><td class="paramname">_id</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="aac5d4b58545db8c3034c8bddf5680e1e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::broadcastOriginFrame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#aac5d4b58545db8c3034c8bddf5680e1e" title="VisualLocalization::broadcastOriginFrame broadcast the nav_origin frame using a tf Transform and gett...">VisualLocalization::broadcastOriginFrame</a> broadcast the nav_origin frame using a tf Transform and getting the position/angle from the estimated car position. </p>

</div>
</div>
<a class="anchor" id="aef7bce395d06c902c2c1a6c5dcf71fe7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::calculateOriginOrientation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#aef7bce395d06c902c2c1a6c5dcf71fe7" title="VisualLocalization::calculateOriginOrientation The orientation of the origin is set accordin to the v...">VisualLocalization::calculateOriginOrientation</a> The orientation of the origin is set accordin to the vector pointing from the car position to the centroid of the three landmarks. As the centroid is not in the middle of the lane, this orientation is not 100% accurate, but AMCL can correct small deviations over time. </p>

</div>
</div>
<a class="anchor" id="af703fd094a6dc992581bb7954a4a510b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::cbAmclPose </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::PoseWithCovariance::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#af703fd094a6dc992581bb7954a4a510b" title="VisualLocalization::cbAmclPose callback function of &quot;/amcl_pose&quot;. Member attribute m_amclPose is set ...">VisualLocalization::cbAmclPose</a> callback function of "/amcl_pose". Member attribute m_amclPose is set to the msg pose. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af24bab6e4fa9dce96a819264699fee89"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::cbCamImg </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::Image::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>_img</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#af24bab6e4fa9dce96a819264699fee89" title="VisualLocalization::cbCamImg callback function of camera image. The camera image is published from th...">VisualLocalization::cbCamImg</a> callback function of camera image. The camera image is published from the usb_cam package. Every image frame is searched for templates and if any are found, their position is saved in the m_detectedTpl vector. The triangluation approach is only executed when three landmarks are detected. If only one is detected a simpler localization approach is done. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_img</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa7279ea7c6413cc17500684755f9e3b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::cbLaserScan </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::LaserScan::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>scan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#aa7279ea7c6413cc17500684755f9e3b9" title="VisualLocalization::cbLaserScan get distance measure from laser scanner. ">VisualLocalization::cbLaserScan</a> get distance measure from laser scanner. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scan</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ace24662571a6c52c54b3c2d8a1f2378a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::cbMap </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::ImageConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#ace24662571a6c52c54b3c2d8a1f2378a" title="VisualLocalization::cbMap callback function when message is received from hector_compressed_map_trans...">VisualLocalization::cbMap</a> callback function when message is received from hector_compressed_map_transport package. As soon as a message is received the templates are localized within the image of the map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a58f7bd6939465f5d79ab2a6774c98dc0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::cbParticles </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::PoseArray::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>_particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#a58f7bd6939465f5d79ab2a6774c98dc0" title="VisualLocalization::cbParticles fetch poses from amcl and store them in a member attribute. ">VisualLocalization::cbParticles</a> fetch poses from amcl and store them in a member attribute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_particles</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af72fb58b92100e7215521c90203e3e4f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::cbTplDetect </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::PoseArray::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#af72fb58b92100e7215521c90203e3e4f" title="VisualLocalization::cbTplDetect (Alternative) callback function that gets called when 3 templates are...">VisualLocalization::cbTplDetect</a> (Alternative) callback function that gets called when 3 templates are detected. The method is not used during the current execution of the node. The purpose of this method is to act as an interface between my node and Benni's object_detection node that finds the templates by SIFT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abddfb494153dca6f8c323d9f02798d86"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double VisualLocalization::convertPointToAngle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTemplateImgData.html">TemplateImgData</a> &amp;&#160;</td>
          <td class="paramname"><em>_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#abddfb494153dca6f8c323d9f02798d86" title="VisualLocalization::convertPointToAngle convert a pixel point to an angle in the FOV. ">VisualLocalization::convertPointToAngle</a> convert a pixel point to an angle in the FOV. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_pt</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="a05a38d85e8c2f2e8a3987f709576d823"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Point2f VisualLocalization::estimatePosition </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="structLandmarkData.html">LandmarkData</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>_lm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#a05a38d85e8c2f2e8a3987f709576d823" title="VisualLocalization::estimatePosition estimate position of car based on its distance from the landmark...">VisualLocalization::estimatePosition</a> estimate position of car based on its distance from the landmarks. For the three landmarks (call them A,B,C) we know the distances and so we can write a system of three non-linear equations: I: (dist_a)^2 = (x-x_a)^2 + (x-x_b)^2 II: (dist_b)^2 = (x-x_b)^2 + (x-x_b)^2 III: (dist_c)^2 = (x-x_c)^2 + (x-x_c)^2 the solution of this system is evaluated in this method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_lm</td><td></td></tr>
    <tr><td class="paramname">da</td><td></td></tr>
    <tr><td class="paramname">db</td><td></td></tr>
    <tr><td class="paramname">dc</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Point2f position </dd></dl>

</div>
</div>
<a class="anchor" id="ab88a3aac781c0d6e99b5dfd0139302cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int VisualLocalization::getRangeFromAngle </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>_angle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#ab88a3aac781c0d6e99b5dfd0139302cd" title="VisualLocalization::getRangeFromAngle convert an angle in the FOV to a range index in the lidar...">VisualLocalization::getRangeFromAngle</a> convert an angle in the FOV to a range index in the lidar. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lrange</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="a0d9dd58e3ea581157a170e0d0116909d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::localize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#a0d9dd58e3ea581157a170e0d0116909d" title="VisualLocalization::localize loop of process. When the initial localization is successful the orienta...">VisualLocalization::localize</a> loop of process. When the initial localization is successful the orientation of the nav_origin frame is calculated and finally the frame is published using a tf broadcaster. </p>

</div>
</div>
<a class="anchor" id="a045c1a0993ac532fd63003c72e769ef9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::locateLandmarksInMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#a045c1a0993ac532fd63003c72e769ef9" title="VisualLocalization::locateLandmarksInMap instantiate LandmarkMatcher object, which calculates landmar...">VisualLocalization::locateLandmarksInMap</a> instantiate <a class="el" href="classLandmarkMatcher.html" title="The LandmarkMatcher class find landmark positions in the map using template matching from OpenCV...">LandmarkMatcher</a> object, which calculates landmark map coordinates. </p>

</div>
</div>
<a class="anchor" id="a38b961874036d47ab6cccc34b899087f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void VisualLocalization::publishPose </td>
          <td>(</td>
          <td class="paramtype">Point2f &amp;&#160;</td>
          <td class="paramname"><em>_pose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#a38b961874036d47ab6cccc34b899087f" title="VisualLocalization::publishPose publish the position of the car into the /initialpose topic...">VisualLocalization::publishPose</a> publish the position of the car into the /initialpose topic. In case of initial localization, the orientation is also set for the nav_origin frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_pose</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae30620e046591295e3a27ee84d6f4f26"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Point2f VisualLocalization::simpleLocalization </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTemplateImgData.html">TemplateImgData</a> &amp;&#160;</td>
          <td class="paramname"><em>_tpl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classVisualLocalization.html#ae30620e046591295e3a27ee84d6f4f26" title="VisualLocalization::simpleLocalization Simple localization approach. The two options for the pose est...">VisualLocalization::simpleLocalization</a> Simple localization approach. The two options for the pose estimate are: 1.) the point in the particle cloud (from AMCL) which lies within 20cm on the circle around the landmark with radius equal to the distance of the landmark from the car. 2.) the point on the circle which is closest to the particle cloud. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_tpl</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a862a0a20423d73fb1e8a01479d9f5b43"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::PoseWithCovariance VisualLocalization::m_amclPose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>AMCL pose estimate (from "/amcl_pose" topic) </p>

</div>
</div>
<a class="anchor" id="a6cf1f11084b51fa47f8db87412d4819e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool VisualLocalization::m_bInitLocalization</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>flag unset when initial localization has successfully happened </p>

</div>
</div>
<a class="anchor" id="aeeeac77dbd819c58382513b00f946a15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mat VisualLocalization::m_camImg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>camera image is saved into an OpenCV Mat format </p>

</div>
</div>
<a class="anchor" id="a66a8d3f235e1e7beab8d86c80b146fee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tf::Vector3 VisualLocalization::m_camPositionInBaseLink</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>camera frame location relative to base link frame </p>

</div>
</div>
<a class="anchor" id="a53e721d8dddb292d2b1bdb5ccefa1d08"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structCarPosition.html">CarPosition</a> VisualLocalization::m_carOrigin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>2D position of car in the map AND orientation </p>

</div>
</div>
<a class="anchor" id="ac2b40bd60b1e0f9dc3292e5a633bc367"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="structTemplateImgData.html">TemplateImgData</a>&gt; VisualLocalization::m_detectedTpl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>contains position of templates in pixel and world coordinates,as well as the distance from the car </p>

</div>
</div>
<a class="anchor" id="acc5f72813488a0f0aa7e9a9cb5a0dc53"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool VisualLocalization::m_gotMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a flag is set when the map image is received </p>

</div>
</div>
<a class="anchor" id="adbe376f70f7c845fca8174c01697e21a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool VisualLocalization::m_gotPoseArray</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set true when amcl particle cloud is received </p>

</div>
</div>
<a class="anchor" id="ad5656ed36f8f00c3799d0e26c2f6bea6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="structLandmarkData.html">LandmarkData</a>&gt; VisualLocalization::m_landmarks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>contains position of landmarks in the map (world coordinates) </p>

</div>
</div>
<a class="anchor" id="a142c0b69def02005bd110a6a437656e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="structLoadedTemplateData.html">LoadedTemplateData</a>&gt;&amp; VisualLocalization::m_loadedTemplates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reference to loaded templates </p>

</div>
</div>
<a class="anchor" id="a521a5d5f9441e04b207e9904712448a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Mat VisualLocalization::m_mapImg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>map in Mat format for further processing </p>

</div>
</div>
<a class="anchor" id="a2820938a4d8bc2d263a84e9c17013e61"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::NodeHandle&amp; VisualLocalization::m_nh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>node handle </p>

</div>
</div>
<a class="anchor" id="afd309550c21c60689d4477057b724deb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tf::TransformBroadcaster VisualLocalization::m_originBroadcaster</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tf broadcaster for initial position/nav_origin frame </p>

</div>
</div>
<a class="anchor" id="a1b82cdb4ed734024766ea42133696885"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::PoseArray VisualLocalization::m_particleCloud</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8b154a7b8d5125930da1087ad277d9d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLandmarkDetector.html">LandmarkDetector</a>* VisualLocalization::m_pLandmarkDetector</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a003f1e5ce410a0a34648cea415b2bd75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLandmarkMatcher.html">LandmarkMatcher</a>* VisualLocalization::m_pLandmarkMatcher</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>used to find landmarks in map (not in camera image) </p>

</div>
</div>
<a class="anchor" id="ae99c41dd8eaec829df9151a6a355fcad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Publisher VisualLocalization::m_pubLandmarks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>publisher of landmark positions </p>

</div>
</div>
<a class="anchor" id="aca2b216ad28cfed9f912845c003d18f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Publisher VisualLocalization::m_pubPosition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>publisher of pose estimate from localization results </p>

</div>
</div>
<a class="anchor" id="af41830fbed0ab025bef6af4ffc6ad97f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber VisualLocalization::m_subAmclPose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscribe to pose estimation by amcl </p>

</div>
</div>
<a class="anchor" id="a695b678e8f29f3a19e5e9b92a189e97d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber VisualLocalization::m_subCamImg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscribe to /usb_cam/image_raw </p>

</div>
</div>
<a class="anchor" id="a9e83c5a0d1b395353aec8cdba3de86a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber VisualLocalization::m_subMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscriber to /map_image/full </p>

</div>
</div>
<a class="anchor" id="aa15109f2af86ac566583ed558d4930b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber VisualLocalization::m_subParticles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscriber to /particlecloud </p>

</div>
</div>
<a class="anchor" id="a7dcf58c7269815aeb8bf42b21ebee8f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber VisualLocalization::m_subScan</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscribe to scan topic </p>

</div>
</div>
<a class="anchor" id="a7966234a43ba4f9f8f2abe0918ea5a9d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ros::Subscriber VisualLocalization::m_subTplDetection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscriber to /tpl_detect </p>

</div>
</div>
<a class="anchor" id="a3f62a13a37965d0bd397704e75315993"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tf::TransformListener VisualLocalization::m_tfListener</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tf listener </p>

</div>
</div>
<a class="anchor" id="ab388f9ea3f09bbb0a0e59e5a78fc749c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr double VisualLocalization::max_scan_angle = 1.57</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9e48b91a6ade88332b227e0aeb214214"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr double VisualLocalization::min_scan_angle = -1.57</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>from scan message </p>

</div>
</div>
<a class="anchor" id="a89d6846c3a7d4a75c3b2410fac9a1e21"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr double VisualLocalization::world_distance_btwn_tpl = 2.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>navigation_tools/visual_localization/src/<a class="el" href="visuallocalization_8h_source.html">visuallocalization.h</a></li>
<li>navigation_tools/visual_localization/src/<a class="el" href="visuallocalization_8cpp.html">visuallocalization.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 1 2017 13:57:10 for Alexandros Sivris TAS contribution by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
